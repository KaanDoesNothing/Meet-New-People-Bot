extends layout.pug

include partials/commands/mixins

block content
    div(class="text-center" id="commands" x-data="window._commandsState()")
        include partials/commands/search

        each command in commands
            +command(command)
            
block extraScripts
    script.
        window._commands = !{JSON.stringify(commands)}
        window._categories = !{JSON.stringify(categories)}

    script.
        window._commandsState = function () {
            return {
                commands: window._commands,
                categories: window._categories,
                filter: "",
                isTrue(name, category) {
                    return name.startsWith(this.filter.toLowerCase()) || category === this.filter;
                }
            }
        }

        //- window.addEventListener("turbolinks:load", () => {
        //-     let input = document.querySelector("#search");

        //-     input.addEventListener("keyup", () => {
        //-         let commands = document.querySelectorAll(".command");

        //-         commands.forEach(cmd => {
        //-             if(cmd.getAttribute("command").startsWith(input.value)) {
        //-                 cmd.style.display = "initial";
        //-                 console.log(cmd.getAttribute("command"));
        //-             }else {
        //-                 cmd.style.display = "none";
        //-             }
        //-         });
        //-     });
        //- });

block extraStyles
    style.
        .search {
            padding: 0% 30% 1%;
        }

        @media(min-width: 768px) {
            #commands {
                margin: 5% 20%;
            }
        }

        .command {
            margin: 1%;
        }